% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/ggplot2-geom.R
\name{geom_surprise}
\alias{geom_surprise}
\title{Surprise Map Geom}
\usage{
geom_surprise(
  mapping = NULL,
  data = NULL,
  position = "identity",
  na.rm = FALSE,
  show.legend = NA,
  inherit.aes = TRUE,
  fill_type = c("surprise", "signed"),
  models = c("uniform", "baserate", "funnel"),
  color = NA,
  colour = color,
  linewidth = 0.1,
  ...
)
}
\arguments{
\item{mapping}{Aesthetic mapping created by \code{\link[ggplot2:aes]{ggplot2::aes()}}.
Required aesthetics are \code{geometry} (from sf) and \code{observed}.
Optional aesthetics include \code{expected} and \code{sample_size}.}

\item{data}{Data (typically an sf object)}

\item{position}{Position adjustment}

\item{na.rm}{Remove NA values?}

\item{show.legend}{Show legend?}

\item{inherit.aes}{Inherit aesthetics from ggplot?}

\item{fill_type}{Type of surprise for fill aesthetic:
\itemize{
\item "surprise": Unsigned surprise (always positive)
\item "signed": Signed surprise (positive = higher than expected,
negative = lower than expected)
}}

\item{models}{Character vector of model types to use.
Options: "uniform", "baserate", "gaussian", "sampled", "funnel"}

\item{color, colour}{Border color for polygons}

\item{linewidth}{Border line width}

\item{...}{Additional arguments passed to the layer}
}
\value{
A list of ggplot2 layers
}
\description{
A convenience geom that combines \code{stat_surprise} with \code{geom_sf} for
easy creation of surprise maps.
}
\section{Aesthetics}{

\code{geom_surprise} understands the following aesthetics:
\describe{
\item{geometry}{sf geometry column (required)}
\item{observed}{Observed values (required)}
\item{expected}{Expected values (optional, for base rate model)}
\item{sample_size}{Sample sizes (optional, for funnel model)}
\item{fill}{Mapped to surprise by default}
\item{color/colour}{Border color}
}
}

\examples{
library(ggplot2)
library(sf)

nc <- st_read(system.file("shape/nc.shp", package = "sf"), quiet = TRUE)

# Basic surprise map - geometry must be mapped explicitly
ggplot(nc) +
  geom_surprise(aes(geometry = geometry, observed = SID74, expected = BIR74)) +
  scale_fill_surprise()

# Signed surprise with diverging scale
ggplot(nc) +
  geom_surprise(
    aes(geometry = geometry, observed = SID74, expected = BIR74),
    fill_type = "signed"
  ) +
  scale_fill_surprise_diverging()

# Customize appearance
ggplot(nc) +
  geom_surprise(
    aes(geometry = geometry, observed = SID74, expected = BIR74),
    color = "white",
    linewidth = 0.2
  ) +
  scale_fill_surprise() +
  theme_minimal()
}
