<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Understanding Model Types</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Understanding Model Types</h1>



<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(bayesiansurprise)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="co">#&gt; bayesiansurprise: Bayesian Surprise for De-Biasing Thematic Maps</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="co">#&gt; Based on Correll &amp; Heer (2017) - IEEE InfoVis</span></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="co">#&gt; Warning: package &#39;sf&#39; was built under R version 4.5.2</span></span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a><span class="co">#&gt; Linking to GEOS 3.13.0, GDAL 3.8.5, PROJ 9.5.1; sf_use_s2() is TRUE</span></span></code></pre></div>
<div id="overview" class="section level2">
<h2>Overview</h2>
<p>The <code>bayesiansurprise</code> package provides five model types
that represent different hypotheses about how data might be distributed.
Bayesian Surprise measures how much our beliefs about which model is
correct change after observing data.</p>
</div>
<div id="the-five-model-types" class="section level2">
<h2>The Five Model Types</h2>
<div id="uniform-model-bs_model_uniform" class="section level3">
<h3>1. Uniform Model (<code>bs_model_uniform</code>)</h3>
<p>The uniform model assumes all observations are equally likely
regardless of any contextual factors.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>model_uniform <span class="ot">&lt;-</span> <span class="fu">bs_model_uniform</span>()</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="fu">print</span>(model_uniform)</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a><span class="co">#&gt; &lt;bs_model: uniform &gt;</span></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a><span class="co">#&gt;   Name: Uniform </span></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a><span class="co">#&gt;   Parameters:</span></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a><span class="co">#&gt;     n_regions :</span></span></code></pre></div>
<p><strong>Use when</strong>: You want to detect any deviation from
uniform distribution.</p>
<p><strong>Likelihood</strong>: Each observation has probability 1/n
where n is the number of observations.</p>
</div>
<div id="base-rate-model-bs_model_baserate" class="section level3">
<h3>2. Base Rate Model (<code>bs_model_baserate</code>)</h3>
<p>The base rate model assumes observations follow a known baseline
distribution (e.g., population proportions).</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>nc <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="fu">system.file</span>(<span class="st">&quot;shape/nc.shp&quot;</span>, <span class="at">package =</span> <span class="st">&quot;sf&quot;</span>), <span class="at">quiet =</span> <span class="cn">TRUE</span>)</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="co"># Create base rate model from birth counts</span></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>model_baserate <span class="ot">&lt;-</span> <span class="fu">bs_model_baserate</span>(nc<span class="sc">$</span>BIR74)</span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a><span class="fu">print</span>(model_baserate)</span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a><span class="co">#&gt; &lt;bs_model: baserate &gt;</span></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a><span class="co">#&gt;   Name: Base Rate </span></span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a><span class="co">#&gt;   Parameters:</span></span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a><span class="co">#&gt;     expected : [ 100 values]</span></span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a><span class="co">#&gt;     expected_prop : [ 100 values]</span></span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a><span class="co">#&gt;     normalize : TRUE</span></span></code></pre></div>
<p><strong>Use when</strong>: You have expected values (population,
baseline rates) and want to detect deviations from them.</p>
<p><strong>Likelihood</strong>: Probability proportional to expected
values (normalized to sum to 1).</p>
</div>
<div id="gaussian-model-bs_model_gaussian" class="section level3">
<h3>3. Gaussian Model (<code>bs_model_gaussian</code>)</h3>
<p>The Gaussian model assumes observations follow a normal distribution,
either with fixed parameters or fitted from the data.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="co"># Fit from data</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>model_gaussian_fit <span class="ot">&lt;-</span> <span class="fu">bs_model_gaussian</span>()</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a><span class="co"># Fixed parameters</span></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>model_gaussian_fixed <span class="ot">&lt;-</span> <span class="fu">bs_model_gaussian</span>(<span class="at">mu =</span> <span class="dv">100</span>, <span class="at">sigma =</span> <span class="dv">20</span>, <span class="at">fit_from_data =</span> <span class="cn">FALSE</span>)</span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a><span class="fu">print</span>(model_gaussian_fixed)</span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a><span class="co">#&gt; &lt;bs_model: gaussian &gt;</span></span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a><span class="co">#&gt;   Name: Gaussian </span></span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a><span class="co">#&gt;   Parameters:</span></span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a><span class="co">#&gt;     mu : 100 </span></span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a><span class="co">#&gt;     sigma : 20 </span></span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a><span class="co">#&gt;     fit_from_data : FALSE</span></span></code></pre></div>
<p><strong>Use when</strong>: You expect data to follow a normal
distribution and want to detect outliers.</p>
<p><strong>Likelihood</strong>: Based on normal PDF with given (or
estimated) mean and standard deviation.</p>
</div>
<div id="sampledkde-model-bs_model_sampled" class="section level3">
<h3>4. Sampled/KDE Model (<code>bs_model_sampled</code>)</h3>
<p>The sampled model uses kernel density estimation (KDE) to create an
empirical distribution from the data itself.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="co"># Sample 20% of data for KDE</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>model_sampled <span class="ot">&lt;-</span> <span class="fu">bs_model_sampled</span>(<span class="at">sample_frac =</span> <span class="fl">0.2</span>, <span class="at">kernel =</span> <span class="st">&quot;gaussian&quot;</span>)</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a><span class="fu">print</span>(model_sampled)</span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a><span class="co">#&gt; &lt;bs_model: sampled &gt;</span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a><span class="co">#&gt;   Name: Sampled (KDE) </span></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a><span class="co">#&gt;   Parameters:</span></span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a><span class="co">#&gt;     sample_frac : 0.2 </span></span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a><span class="co">#&gt;     kernel : gaussian </span></span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a><span class="co">#&gt;     bandwidth : nrd0 </span></span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a><span class="co">#&gt;     sample_indices :</span></span></code></pre></div>
<p><strong>Use when</strong>: You want a data-driven baseline without
parametric assumptions.</p>
<p><strong>Likelihood</strong>: Evaluated from kernel density estimate
of sampled data.</p>
</div>
<div id="de-moivre-funnel-model-bs_model_funnel" class="section level3">
<h3>5. de Moivre Funnel Model (<code>bs_model_funnel</code>)</h3>
<p>The funnel model accounts for sampling variance, recognizing that
smaller samples have higher natural variability.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="co"># Create funnel model with sample sizes</span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>model_funnel <span class="ot">&lt;-</span> <span class="fu">bs_model_funnel</span>(nc<span class="sc">$</span>BIR74, <span class="at">type =</span> <span class="st">&quot;count&quot;</span>)</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a><span class="fu">print</span>(model_funnel)</span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a><span class="co">#&gt; &lt;bs_model: funnel &gt;</span></span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a><span class="co">#&gt;   Name: de Moivre Funnel (paper) </span></span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a><span class="co">#&gt;   Parameters:</span></span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a><span class="co">#&gt;     sample_size : [ 100 values]</span></span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a><span class="co">#&gt;     target_rate :  </span></span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a><span class="co">#&gt;     type : count </span></span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a><span class="co">#&gt;     formula : paper </span></span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a><span class="co">#&gt;     control_limits : 2, 3</span></span></code></pre></div>
<p><strong>Use when</strong>: Observations come from samples of
different sizes and you want to account for sampling error.</p>
<p><strong>Likelihood</strong>: Based on z-scores computed from expected
standard error given sample size.</p>
</div>
</div>
<div id="combining-models-model-space" class="section level2">
<h2>Combining Models: Model Space</h2>
<p>Models are combined into a “model space” with prior
probabilities:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="co"># Default model space (uniform + baserate + funnel)</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>space_default <span class="ot">&lt;-</span> <span class="fu">default_model_space</span>(nc<span class="sc">$</span>BIR74)</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a><span class="fu">print</span>(space_default)</span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a><span class="co">#&gt; &lt;bs_model_space&gt;</span></span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a><span class="co">#&gt;   Models: 3 </span></span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a><span class="co">#&gt;    1. Uniform (prior: 0.3333)</span></span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a><span class="co">#&gt;    2. Base Rate (prior: 0.3333)</span></span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a><span class="co">#&gt;    3. de Moivre Funnel (paper) (prior: 0.3333)</span></span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="co"># Custom model space with explicit prior</span></span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>space_custom <span class="ot">&lt;-</span> <span class="fu">model_space</span>(</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>  <span class="fu">bs_model_uniform</span>(),</span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a>  <span class="fu">bs_model_baserate</span>(nc<span class="sc">$</span>BIR74),</span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a>  <span class="fu">bs_model_gaussian</span>(),</span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a>  <span class="fu">bs_model_funnel</span>(nc<span class="sc">$</span>BIR74),</span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a>  <span class="at">prior =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.4</span>, <span class="fl">0.2</span>, <span class="fl">0.3</span>),</span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a>  <span class="at">names =</span> <span class="fu">c</span>(<span class="st">&quot;Uniform&quot;</span>, <span class="st">&quot;Population&quot;</span>, <span class="st">&quot;Normal&quot;</span>, <span class="st">&quot;Funnel&quot;</span>)</span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a>)</span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a><span class="fu">print</span>(space_custom)</span>
<span id="cb8-11"><a href="#cb8-11" tabindex="-1"></a><span class="co">#&gt; &lt;bs_model_space&gt;</span></span>
<span id="cb8-12"><a href="#cb8-12" tabindex="-1"></a><span class="co">#&gt;   Models: 4 </span></span>
<span id="cb8-13"><a href="#cb8-13" tabindex="-1"></a><span class="co">#&gt;    1. Uniform (prior: 0.1)</span></span>
<span id="cb8-14"><a href="#cb8-14" tabindex="-1"></a><span class="co">#&gt;    2. Population (prior: 0.4)</span></span>
<span id="cb8-15"><a href="#cb8-15" tabindex="-1"></a><span class="co">#&gt;    3. Normal (prior: 0.2)</span></span>
<span id="cb8-16"><a href="#cb8-16" tabindex="-1"></a><span class="co">#&gt;    4. Funnel (prior: 0.3)</span></span></code></pre></div>
</div>
<div id="how-models-affect-surprise" class="section level2">
<h2>How Models Affect Surprise</h2>
<p>Different model combinations highlight different aspects of the
data:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="co"># Only uniform model - highlights any non-uniform distribution</span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>result_uniform <span class="ot">&lt;-</span> <span class="fu">surprise</span>(nc, <span class="at">observed =</span> SID74,</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>                          <span class="at">models =</span> <span class="fu">model_space</span>(<span class="fu">bs_model_uniform</span>()))</span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a><span class="co"># Uniform + baserate - highlights deviation from population proportion</span></span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a>result_pop <span class="ot">&lt;-</span> <span class="fu">surprise</span>(nc, <span class="at">observed =</span> SID74, <span class="at">expected =</span> BIR74,</span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a>                      <span class="at">models =</span> <span class="fu">model_space</span>(</span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a>                        <span class="fu">bs_model_uniform</span>(),</span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a>                        <span class="fu">bs_model_baserate</span>(nc<span class="sc">$</span>BIR74)</span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a>                      ))</span>
<span id="cb9-11"><a href="#cb9-11" tabindex="-1"></a></span>
<span id="cb9-12"><a href="#cb9-12" tabindex="-1"></a><span class="co"># Full default - accounts for sampling variance too</span></span>
<span id="cb9-13"><a href="#cb9-13" tabindex="-1"></a>result_full <span class="ot">&lt;-</span> <span class="fu">surprise</span>(nc, <span class="at">observed =</span> SID74, <span class="at">expected =</span> BIR74)</span>
<span id="cb9-14"><a href="#cb9-14" tabindex="-1"></a></span>
<span id="cb9-15"><a href="#cb9-15" tabindex="-1"></a><span class="co"># Compare max surprise values</span></span>
<span id="cb9-16"><a href="#cb9-16" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Uniform only, max surprise:&quot;</span>, <span class="fu">max</span>(result_uniform<span class="sc">$</span>surprise), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb9-17"><a href="#cb9-17" tabindex="-1"></a><span class="co">#&gt; Uniform only, max surprise: 0</span></span>
<span id="cb9-18"><a href="#cb9-18" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;With base rate, max surprise:&quot;</span>, <span class="fu">max</span>(result_pop<span class="sc">$</span>surprise), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb9-19"><a href="#cb9-19" tabindex="-1"></a><span class="co">#&gt; With base rate, max surprise: 0.9999773</span></span>
<span id="cb9-20"><a href="#cb9-20" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Full model space, max surprise:&quot;</span>, <span class="fu">max</span>(result_full<span class="sc">$</span>surprise), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb9-21"><a href="#cb9-21" tabindex="-1"></a><span class="co">#&gt; Full model space, max surprise: 0.6008295</span></span></code></pre></div>
</div>
<div id="posterior-model-weights" class="section level2">
<h2>Posterior Model Weights</h2>
<p>After computing surprise, you can examine how beliefs about models
have changed:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">surprise</span>(nc, <span class="at">observed =</span> SID74, <span class="at">expected =</span> BIR74)</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a><span class="co"># Prior weights</span></span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Prior:&quot;</span>, result<span class="sc">$</span>model_space<span class="sc">$</span>prior, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a><span class="co">#&gt; Prior:</span></span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a></span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a><span class="co"># Posterior weights (after seeing all data)</span></span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Posterior:&quot;</span>, result<span class="sc">$</span>model_space<span class="sc">$</span>posterior, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a><span class="co">#&gt; Posterior:</span></span></code></pre></div>
</div>
<div id="guidelines-for-model-selection" class="section level2">
<h2>Guidelines for Model Selection</h2>
<table>
<thead>
<tr class="header">
<th>Scenario</th>
<th>Recommended Models</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Raw counts, no baseline</td>
<td>Uniform, Gaussian</td>
</tr>
<tr class="even">
<td>Counts with population data</td>
<td>Uniform, Base Rate, Funnel</td>
</tr>
<tr class="odd">
<td>Rates/proportions</td>
<td>Uniform, Base Rate</td>
</tr>
<tr class="even">
<td>Exploratory analysis</td>
<td>Default (all three)</td>
</tr>
<tr class="odd">
<td>Small samples prevalent</td>
<td>Include Funnel</td>
</tr>
<tr class="even">
<td>Unknown distribution</td>
<td>Include Sampled/KDE</td>
</tr>
</tbody>
</table>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
